{
	"comment": "set the HomeDirectory from sftp pwd",
	"type": "SecureFtp",
	"id": 411000,
	"sftp_script": "'pwd'",
	"on_complete": {
		"type": "LinearLayout",
		"scrollable": true,
		"orientation": "vertical",
		"gravity": "center_horizontal",
		"layout_width": "match_parent",
		"component_list": [
			{
				"type": "Clone",
				"name": "HorizontalLine"
			},
			{
				"type": "Clone",
				"name": "TextViewLabel",
				"attributes": {
					"text": "Encrypt File"
				}
			},
			{
				"type": "Clone",
				"name": "TextViewDetail",
				"attributes": {
					"text_list": [
						"After a public key file has been imported, you can create an OpenPGP encryption file for a particular file to ensure it's privacy"
					]
				}
			},
			{
				"type": "Clone",
				"name": "TextViewLabel",
				"attributes": {
					"text": "Select File (for which to create an OpenPGP encryption file):"
				}
			},
			{
				"type": "EditText",
				"id": 6699,
				"max_length": 200,
				"is_single_line": true,
				"layout_width": "match_parent",
				"text_color": "#ffffff",
				"background_color": "#000000"
			},
			{
				"type": "JavaScript",
				"comment": [
					"set home_dir_cache: 'SecureFtp:411000'",
					"set targetVid: 6699",
					"set work_dir: ''"
				],
				"script_list": [
					"var home_dir_cache = 'SecureFtp:411000'",
					"var targetVid = 6699",
					"var work_dir = ''",
					"var home_dir = eigenFragment.getCacheString(home_dir_cache)",
					"eigenFragment.setCacheString('HomeDirectory', home_dir)",
					"eigenFragment.setCacheString('WorkingDirectory', work_dir)",
					"var selected_path = eigenFragment.getCacheString('SelectedPath')",
					"var full_path = eigenFragment.concatPaths(home_dir, work_dir, selected_path)",
					"eigenFragment.setCacheString('FullPath', full_path)",
					"var selected_file = eigenFragment.getCacheString('SelectedFile')",
					"var selected_filepath = eigenFragment.concatPaths(full_path, selected_file)",
					"eigenFragment.setIntegerVariable('TargetViewId', 0, targetVid)",
					"eigenFragment.setViewState(targetVid, selected_filepath)"
				]
			},
			{
				"type": "Clone",
				"name": "ButtonDefault",
				"attributes": {
					"text": "Select File to Encrypt",
					"icon": {
						"name": "open_with.",
						"location": "top"
					},
					"on_click": {
						"type": "ActionList",
						"comment": "set the dialog type, then start popup",
						"component_list": [
							{
								"type": "JavaScript",
								"script_list": [
									"eigenFragment.setBooleanVariable('IsShowWorkingDirectory',0,false)",
									"eigenFragment.setBooleanVariable('IsShowCurrentFilename',0,true)"
								]
							},
							{
								"type": "Clone",
								"name": "PopupScreenDefault",
								"attributes": {
									"id": 991005,
									"title": "Select Private Key File",
									"url": "https://raw.githubusercontent.com/jsawaya/eigenframe/master/web/frames/select-filepath.json"
								}
							}
						]
					}
				}
			},
			{
				"type": "Clone",
				"name": "HorizontalLine"
			},
			{
				"type": "Clone",
				"name": "TextViewLabel",
				"attributes": {
					"text": "Private KeyId:"
				}
			},
			{
				"type": "Clone",
				"name": "TextViewDetail",
				"attributes": {
					"text_list": [
						"Try the demo-private-key KeyId: 5C91FC661620EAFA"
					]
				}
			},
			{
				"type": "EditText",
				"id": 6607,
				"is_single_line": true,
				"layout_width": "match_parent",
				"layout_height": "wrap_content",
				"text_color": "#ffffff",
				"background_color": "#000000",
				"text": "5C91FC661620EAFA"
			},
			{
				"type": "Clone",
				"name": "HorizontalLine"
			},
			{
				"type": "Clone",
				"name": "TextViewLabel",
				"attributes": {
					"text": "Format: asc (ASCII Armor) | pgp (Binary)"
				}
			},
			{
				"type": "EditText",
				"id": 6606,
				"is_single_line": true,
				"layout_width": "match_parent",
				"layout_height": "wrap_content",
				"text_color": "#ffffff",
				"background_color": "#000000",
				"text": "asc"
			},
			{
				"type": "x-Button",
				"text": "Create an OpenPGP Encryption File",
				"layout_width": "wrap_content",
				"layout_height": "wrap_content",
				"text_color": "#ffffff",
				"background_color": "#654321",
				"icon": {
					"name": "info.",
					"location": "top"
				},
				"on_click": {
					"type": "UrlRequest",
					"id": 6605,
					"is_eigen_response": false,
					"url": "http://localhost:8080/cgi-bin/cgi_ruby.rb",
					"parameter_list": [
						{
							"name": "targetfile",
							"value_script_list": [
								"var targetVid = eigenFragment.getIntegerVariable('TargetViewId', 0, 0)",
								"var targetfile = eigenFragment.getViewState(targetVid)",
								"'' + targetfile"
							]
						},
						{
							"name": "keyid",
							"value_script_list": [
								"'' + eigenFragment.getCacheString('EditText:6607')"
							]
						},
						{
							"name": "format",
							"value_script_list": [
								"'' + eigenFragment.getCacheString('EditText:6606')"
							]
						},
						{
							"name": "ruby",
							"value_list": [
								"keyid = cgi.params['keyid'][0]",
								"targetfile = cgi.params['targetfile'][0]",
								"format = cgi.params['format'][0]",
								"gpg_encrypt(keyid, targetfile, format).to_json.to_s"
							]
						}
					],
					"on_complete": {
						"type": "Clone",
						"name": "PopupScreenDefault",
						"attributes": {
							"title": "Create an OpenPGP Encryption File",
							"component_list": [
								{
									"type": "Clone",
									"name": "LayoutVerticalScrollable",
									"attributes": {
										"component_list": [
											{
												"type": "Clone",
												"name": "TextViewDetail",
												"attributes": {
													"url": "file:///data/user/0/com.sawaya.eigenframe/files/UrlRequest:6605"
												}
											}
										]
									}
								}
							]
						}
					}
				}
			}
		]
	}
}
