{
  "type": "LinearLayout",
  "scrollable": true,
  "orientation": "vertical",
  "gravity": "center_horizontal",
  "layout_width": "match_parent",
  "component_list": [
    {
      "type": "Define",
      "name": "EditTextRemoteFilePath",
      "component": {
        "type": "EditText",
        "id": 999001,
        "max_length": 200,
        "is_single_line": true,
        "layout_width": "match_parent",
        "text": "",
        "text_color": "#ffffff",
        "background_color": "#000000",
        "margin": {
          "left": 10,
          "top": 10,
          "right": 10,
          "bottom": 10
        }
      }
    },
    {
      "type": "Define",
      "name": "EditTextLocalFileCache",
      "component": {
        "type": "EditText",
        "url_script": "'file://' + eigenFragment.getCacheFilePath('EditText:999000') ",
        "id": 999000,
        "gravity": "left",
        "layout_width": "match_parent",
        "text_color": "#ffffff",
        "background_color": "#000000"
      }
    },


    {
      "type": "Define",
      "name": "ButtonSaveEditsToRemoteFile",
      "component": {
        "type": "Clone",
        "name": "ButtonDefault",
        "attributes": {
          "text": "Save Edits to Remote File",
          "icon": {
            "name": "save.",
            "location": "top"
          },
          "on_click": {
            "type": "ActionList",
            "component_list": [
              {
                "type": "SecureFtp",
                "sftp_script": "'put EditText:999000 ' + eigenFragment.getViewState(999001)",
                "on_complete": {
                  "type": "JavaScript",
                  "script_list": [
                    "var x1 = eigenFragment.clearCacheFile('EditText:999000')",
                    "eigenActivity.showToast('Local File Cache Status: ' + x1 )"
                  ]
                }
              },
              {
                "type": "JavaScript",
                "comment": "closePopupWindow needs to be here, rather than inside SecureFtp(on-complete)/JavaScript, because it seeks parent views to find PopupScreen",
                "script_list": [
                  "eigenFragment.closePopupWindow()"
                ]
              }
            ]
          }
        }
      }
    },
    {
      "type": "Define",
      "name": "ButtonCancelLocalEdits",
      "component": {
        "type": "Clone",
        "name": "ButtonDefault",
        "attributes": {
          "text": "Cancel Local Edits",
          "icon": {
            "name": "cancel.",
            "location": "top"
          },
          "on_click": {
            "type": "JavaScript",
            "script_list": [
              "var x1 = eigenFragment.clearCacheFile('EditText:999000')",
              "eigenActivity.showToast('Edit Cache: ' + x1 )",
              "eigenFragment.closePopupWindow(999099)"
            ]
          }
        }
      }
    },
    {
      "type": "Define",
      "name": "PopupScreenEdit",
      "component": {
        "type": "Clone",
        "name": "PopupScreenDefault",
        "attributes": {
          "id": 999099,
          "title_script": "'Remote file: '+eigenFragment.getViewState(999001)",
          "component_list": [
            {
              "type": "Clone",
              "name": "LayoutVerticalScrollable",
              "attributes": {
                "component_list": [
                  {
                    "type": "Clone",
                    "name": "ButtonSaveEditsToRemoteFile"
                  },
                  {
                    "type": "Clone",
                    "name": "ButtonCancelLocalEdits"
                  },
                  {
                    "type": "Clone",
                    "name": "EditTextLocalFileCache"
                  }
                ]
              }
            }
          ]
        }
      }
    },
    {
      "type": "Define",
      "name": "PopupScreenShowRemoteFile",
      "component": {
        "type": "Clone",
        "name": "PopupScreenDefault",
        "attributes": {
          "title_script": "'Remote file: '+eigenFragment.getViewState(999001)",
          "component_list": [
            {
              "type": "Clone",
              "name": "LayoutVerticalScrollable",
              "attributes": {
                "component_list": [
                  {
                    "type": "Clone",
                    "name": "TextViewDetail",
                    "attributes": {
                      "ssh_script": "'cat ' + eigenFragment.getViewState(999001)"
                    }
                  }
                ]
              }
            }
          ]
        }
      }
    },

    {
      "type": "Clone",
      "name": "TextViewLabel",
      "attributes": {
        "text": "Remote file path: \n(relative to sftp home directory)"
      }
    },
    {
      "type": "Clone",
      "name": "EditTextRemoteFilePath"
    },
    {
      "type": "Clone",
      "name": "HorizontalLine"
    },
    {
      "type": "x-Clone",
      "name": "ButtonDefault",
      "attributes": {
        "text": "Show remote file",
        "icon": {
          "name": "open_browser.",
          "location": "top"
        },
        "on_click": {
          "type": "Clone",
          "name": "PopupScreenShowRemoteFile"
        }
      }
    },
    {
      "type": "x-Clone",
      "name": "ButtonDefault",
      "attributes": {
        "text": "Get local cache",
        "icon": {
          "name": "open_browser.",
          "location": "top"
        },
        "on_click": {
          "type": "Clone",
          "name": "PopupScreenDefault",
          "attributes": {
            "title_script": "'Local cache: '+eigenFragment.getCacheFilePath('EditText:999000')",
            "component_list": [
              {
                "type": "Clone",
                "name": "LayoutVerticalScrollable",
                "attributes": {
                  "component_list": [
                    {
                      "type": "SecureFtp",
                      "sftp_script": "'get ' + eigenFragment.getViewState(999001) + ' EditText:999000'",
                      "on_complete": {
                        "type": "Clone",
                        "name": "TextViewDetail",
                        "attributes": {
                          "url_script": "'file://' + eigenFragment.getCacheFilePath('EditText:999000') "
                        }
                      }
                    }
                  ]
                }
              }
            ]
          }
        }
      }
    },
    {
      "type": "x-Clone",
      "name": "ButtonDefault",
      "attributes": {
        "text": "Edit local cache",
        "icon": {
          "name": "edit.",
          "location": "top"
        },
        "on_click": {
          "type": "Clone",
          "name": "PopupScreenEdit"
        }
      }
    },
    {
      "type": "Clone",
      "name": "ButtonDefault",
      "attributes": {
        "text": "Edit Copy of Remote File",
        "icon": {
          "name": "open_browser.",
          "location": "top"
        },
        "on_click": {
          "type": "SecureFtp",
          "sftp_script": "'get ' + eigenFragment.getViewState(999001) + ' EditText:999000'",
          "on_complete": {
            "type": "Clone",
            "name": "PopupScreenEdit"
          }
        }
      }
    }
  ]
}


